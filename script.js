!function(){function e(e){const t=e.match(/([0-9]+).h5/)[1],n=t.substring(0,4)+"-"+t.substring(4,6)+"-"+t.substring(6,8)+"T"+t.substring(8,10)+":"+t.substring(10,12)+"Z";return new Date(Date.parse(n))}function t(e){return dayjs(e).format("H:mm")}"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("service-worker.js").then((function(e){}),(function(e){})).catch((function(e){}))})),dayjs.locale("nl-be");const n=L.map("map").setView([50.3,4.5],8);L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:20}).addTo(n);const o=L.layerGroup();async function r(){const n=await fetch("https://pieterprovoost-hagel.s3.eu-central-1.amazonaws.com/hagel.json"),r=await n.json(),a=Object.keys(r.images).sort(),s=a.slice(-9),i=s.map(e).map(t),c=["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"].slice(-s.length),d=s.map(((e,t)=>{if("string"==typeof r.images[e]){const n=JSON.parse(r.images[e]);return L.geoJSON(n,{color:c[t],weight:0,fillOpacity:.5,onEachFeature:function(e,t){if(e.properties&&e.properties.p_min){const n=Math.round(e.properties.p_min/255*100),o=Math.round(e.properties.p_max/255*100);let r;r=n===o?"<p>"+n+"% kans</p>":"<p>"+n+" - "+o+"% kans</p>",t.bindPopup(r)}}})}}));o.clearLayers(),d.forEach((e=>{e&&e.addTo(o)}));const p=(l=e(a.slice(-1)[0]),dayjs(l).format("dddd D/M H:mm"));var l;document.getElementById("status").innerHTML=p;const u=document.getElementsByClassName("legend")[0];u.innerHTML="";for(var m=0;m<c.length;m++)u.innerHTML+='<i style="background-color: '+c[m]+'"></i>'+i[m]+"<br/>"}o.addTo(n),L.Control.Legend=L.Control.extend({onAdd:function(){return L.DomUtil.create("div","legend")}}),L.control.legend=function(e){return new L.Control.Legend(e)},L.control.legend({position:"topright"}).addTo(n),L.control.locate({setView:!1,keepCurrentZoomLevel:!0}).addTo(n),r(),setInterval((function(){r()}),6e4)}();