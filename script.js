!function(){function e(e){const t=e.match(/([0-9]+).h5/)[1],n=t.substring(0,4)+"-"+t.substring(4,6)+"-"+t.substring(6,8)+"T"+t.substring(8,10)+":"+t.substring(10,12)+"Z";return new Date(Date.parse(n))}function t(e){return dayjs(e).format("H:mm")}"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("service-worker.js").then((function(e){}),(function(e){})).catch((function(e){}))})),dayjs.locale("nl-be");const n=L.map("map").setView([50.3,4.5],8);L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:20}).addTo(n);const o=L.layerGroup();async function a(){const n=await fetch("https://pieterprovoost-hagel.s3.eu-central-1.amazonaws.com/hagel.json"),a=await n.json(),r=Object.keys(a.images).sort(),i=r.slice(-9),s=i.map(e).map(t),c=["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"].slice(-i.length),l=i.map(((e,t)=>{if("string"==typeof a.images[e]){const n=JSON.parse(a.images[e]);return L.geoJSON(n,{color:c[t],weight:0,fillOpacity:.5,onEachFeature:function(e,t){if(e.properties&&e.properties.p_min){const n=Math.round(e.properties.p_min/255*100),o=Math.round(e.properties.p_max/255*100);let a;a=n===o?"<p>"+n+"% kans</p>":"<p>"+n+" - "+o+"% kans</p>",t.bindPopup(a)}}})}}));o.clearLayers(),l.forEach((e=>{e&&e.addTo(o)}));const d=(p=e(r.slice(-1)[0]),dayjs(p).format("dddd D/M H:mm"));var p;document.getElementById("status").innerHTML=d;const u=document.getElementsByClassName("legend")[0];u.innerHTML="";for(var m=0;m<c.length;m++)u.innerHTML+='<i style="background-color: '+c[m]+'"></i>'+s[m]+"<br/>";if(a.alerts&&a.alerts.length){let e=a.alerts.map((e=>"<h5>"+e.headline+"</h5><p>"+e.description+"</p>")).join("");document.getElementById("alertsBody").innerHTML=e,document.querySelectorAll(".easy-button-container").forEach((function(e){e.style.visibility="visible"}))}else document.querySelectorAll(".easy-button-container").forEach((function(e){e.style.visibility="hidden"})),document.getElementById("alertsBody").innerHTML=""}o.addTo(n),L.Control.Legend=L.Control.extend({onAdd:function(){return L.DomUtil.create("div","legend")}}),L.control.legend=function(e){return new L.Control.Legend(e)},L.control.legend({position:"topright"}).addTo(n),L.control.locate({setView:!1,keepCurrentZoomLevel:!0}).addTo(n),L.easyButton('<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-exclamation-triangle-fill" viewBox="0 0 27 20"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>',(function(e,t){console.log($("#alertsModal")),$("#alertsModal").modal("show")})).addTo(n),a(),setInterval((function(){a()}),6e4)}();